# Supabase エラー解決方法 🔧

## ❌ エラー1: "Please assign a name for your table"

このエラーは、テーブルを作成するときに**テーブル名を入力していない**場合に発生します。

### 解決方法

1. モーダル（ウィンドウ）の上部にある **"Table name"** の入力欄を確認
2. テーブル名を入力（例: `faqs`）
3. **"Save"** ボタンをクリック

**💡 ポイント**: 
- テーブル名は**必ず入力する必要があります**
- カラムを追加する前に、まずテーブル名を入力してください
- テーブル名は英数字とアンダースコア（_）が使えます

---

## ❌ エラー2: "identity column type must be smallint, integer, or bigint"

このエラーは、既存のカラムをIdentityカラムに変更しようとしたときに発生します。

---

## 🎯 解決方法（3つの方法）

### 方法1: テーブルを削除して作り直す（一番簡単！）⭐

**この方法が一番簡単で確実です！**

#### ステップ1: テーブルを削除

1. Supabaseのダッシュボードで **"Table Editor"** を開く
2. `faqs` テーブルをクリック
3. テーブル名の横にある **"..."**（三点リーダー）をクリック
4. **"Delete table"** を選択
5. 確認画面でテーブル名を入力して削除を確認

#### ステップ2: 新しいテーブルを作成

以下の手順で、**最初から正しく**テーブルを作成します：

1. **"Create a new table"** をクリック
2. テーブル名: `faqs` と入力
3. **"Save"** をクリック（まずテーブルだけ作成）

#### ステップ3: idカラムを最初に追加（重要！）

**⚠️ 重要**: idカラムは**最初に**追加する必要があります！

1. **"Add column"** をクリック
2. **Name**: `id`
3. **Type**: `int8` を選択（または `bigint`）
4. **Is Primary Key**: ✅ **チェックを入れる**
5. **Is Identity**: ✅ **チェックを入れる**（これが重要！）
6. **"Save"** をクリック

**💡 ポイント**: 
- `Is Primary Key` と `Is Identity` の**両方**にチェックを入れる
- これで自動的に番号が振られるようになります

#### ステップ4: 残りのカラムを追加

idカラムを作成したら、残りのカラムを追加します：

**列2: question（質問）**
- **Name**: `question`
- **Type**: `text`
- **Is Nullable**: ❌ チェックを外す

**列3: answer（回答）**
- **Name**: `answer`
- **Type**: `text`
- **Is Nullable**: ❌ チェックを外す

**列4: keywords（キーワード）**
- **Name**: `keywords`
- **Type**: `text`
- **Is Nullable**: ✅ チェックを入れる

**列5: created_at（作成日時）**
- **Name**: `created_at`
- **Type**: `timestamptz`
- **Default Value**: `now()`

**列6: updated_at（更新日時）**
- **Name**: `updated_at`
- **Type**: `timestamptz`
- **Default Value**: `now()`

**列7: usage_count（使用回数）**
- **Name**: `usage_count`
- **Type**: `int8`
- **Default Value**: `0`

**列8: category（カテゴリ）**
- **Name**: `category`
- **Type**: `text`
- **Is Nullable**: ✅ チェックを入れる

---

### 方法2: SQLエディタで直接設定する

もし既存のデータを保持したい場合は、SQLエディタを使います。

#### ステップ1: SQLエディタを開く

1. 左メニューから **"SQL Editor"** をクリック
2. **"New query"** をクリック

#### ステップ2: SQLを実行

以下のSQLをコピー&ペーストして実行：

```sql
-- 既存のidカラムを削除（データは保持）
ALTER TABLE faqs DROP COLUMN id;

-- 新しいidカラムを追加（Identity付き）
ALTER TABLE faqs ADD COLUMN id BIGSERIAL PRIMARY KEY;
```

**⚠️ 注意**: この方法を使うと、既存のidの値が消えます。新しい番号が自動で振られます。

---

### 方法3: 手動で正しい順序で作成し直す

既存のテーブルを削除せずに修正したい場合：

#### ステップ1: すべてのカラムを削除（id以外）

1. 各カラムの **"..."** をクリック
2. **"Delete column"** を選択
3. idカラム以外をすべて削除

#### ステップ2: idカラムを削除

1. idカラムの **"..."** をクリック
2. **"Delete column"** を選択

#### ステップ3: 新しいidカラムを作成

1. **"Add column"** をクリック
2. **Name**: `id`
3. **Type**: `int8`
4. **Is Primary Key**: ✅ チェック
5. **Is Identity**: ✅ チェック
6. **"Save"** をクリック

#### ステップ4: 残りのカラムを追加

方法1のステップ4と同じ手順で、残りのカラムを追加します。

---

## ✅ 正しい作成手順（まとめ）

### 重要なポイント

1. **idカラムは最初に作成する**
2. **Is Primary Key と Is Identity の両方にチェックを入れる**
3. **Type は int8（bigint）を選択する**

### チェックリスト

- [ ] テーブルを作成
- [ ] idカラムを最初に追加
- [ ] idカラムのType: `int8` を選択
- [ ] idカラムのIs Primary Key: ✅ チェック
- [ ] idカラムのIs Identity: ✅ チェック
- [ ] idカラムを保存
- [ ] 残りのカラムを追加

---

## 🆘 それでもエラーが出る場合

### 確認事項

1. **Typeが正しいか確認**
   - `int8`、`bigint`、`integer`、`smallint` のいずれかであること
   - `text` や `varchar` ではエラーになります

2. **既存のデータがないか確認**
   - テーブルにデータが入っている場合、一度削除してから設定

3. **ブラウザをリロード**
   - ブラウザのキャッシュが原因の可能性があります
   - ページをリロード（F5キー）して再試行

4. **Supabaseのバージョンを確認**
   - 最新バージョンを使用しているか確認
   - 古いバージョンでは動作しない可能性があります

### 最終手段: サポートに問い合わせ

それでも解決しない場合は：

1. エラーメッセージのスクリーンショットを撮る
2. Supabaseのコミュニティフォーラムで質問
   - URL: https://github.com/supabase/supabase/discussions

---

## 📝 補足: Identityカラムとは？

**Identityカラム**は、自動的に番号を振ってくれるカラムです。

- 1, 2, 3, 4... と自動で番号が振られる
- 手動で番号を入力する必要がない
- データを追加するたびに自動で増える

Excelの「連番」機能と同じようなものです。

---

**作成日**: 2025年1月  
**最終更新**: 2025年1月
