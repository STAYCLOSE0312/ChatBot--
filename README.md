# FAQチャットボットシステム

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Node](https://img.shields.io/badge/node-%3E%3D14.0.0-brightgreen.svg)

## 📖 概要

このシステムは、FAQデータを参照して自動応答するチャットボットです。  
シンプルで美しいLINE風のUIと、簡単に更新できる管理画面を備えています。

### 主な機能

- 🤖 **AIチャットボット**: LINE風の吹き出しUIで直感的な会話
- 📝 **FAQ管理画面**: FAQの追加・編集・削除が簡単にできる
- 🔍 **セマンティック検索**: キーワードマッチングで適切な回答を検索
- 💾 **データ永続化**: JSONファイルでFAQデータを保存
- 🎨 **モダンなUI**: グラデーションとアニメーションを使った美しいデザイン
- 📱 **レスポンシブ対応**: PC・タブレット・スマートフォンに対応

## 🚀 セットアップ方法

### 必要要件

- Node.js (v14.0.0以上)
- npm または yarn

### インストール手順

1. **依存パッケージのインストール**

```bash
npm install
```

2. **サーバーの起動**

```bash
npm start
```

3. **ブラウザでアクセス**

サーバーが起動したら、以下のURLにアクセスできます：

- **チャットボット**: http://localhost:3000/chatbot.html
- **FAQ管理画面**: http://localhost:3000/admin.html

## 📂 プロジェクト構成

```
ChatBot制作/
├── server.js              # バックエンドサーバー (Node.js + Express)
├── package.json           # プロジェクト設定
├── faq-data.json         # FAQデータ (自動生成)
├── public/               # 公開ディレクトリ
│   ├── chatbot.html      # チャットボット画面
│   ├── chatbot.css       # チャットボットスタイル
│   ├── chatbot.js        # チャットボット機能
│   ├── admin.html        # FAQ管理画面
│   ├── admin.css         # 管理画面スタイル
│   └── admin.js          # 管理画面機能
└── README.md             # このファイル
```

## 💡 使い方

### チャットボットの使用

1. `http://localhost:3000/chatbot.html` にアクセス
2. 初回表示時に「よくある質問」がボタンで表示されます
3. ボタンをクリックするか、入力欄に質問を入力して送信
4. チャットボットが適切な回答を返します
5. 関連する質問があれば、回答の下に表示されます

### FAQ管理画面の使用

1. `http://localhost:3000/admin.html` にアクセス
2. 左側のフォームから新しいFAQを追加
   - **質問**: ユーザーが尋ねる質問文
   - **回答**: チャットボットが返す回答
   - **キーワード**: 検索精度を上げるためのキーワード（カンマ区切り）
3. 右側の一覧から既存のFAQを編集・削除

### キーワードの設定方法

キーワードは検索精度を上げるために重要です。  
例えば、「営業時間を教えてください」という質問に対して：

- **キーワード例**: `営業時間, 何時, いつ, 時間, 営業, オープン, 開店`

ユーザーが「何時まで営業していますか？」と聞いても、適切に回答できるようになります。

## 🔧 カスタマイズ

### ポート番号の変更

`server.js` の以下の行を編集：

```javascript
const PORT = process.env.PORT || 3000;
```

### デフォルトFAQの編集

`server.js` の `initializeFAQData()` 関数内の `initialData` を編集してください。

### デザインの変更

- チャットボット: `public/chatbot.css`
- 管理画面: `public/admin.css`

カラーテーマを変更したい場合は、グラデーションの色を編集：

```css
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
```

## 🔍 検索アルゴリズム

現在の実装では、シンプルなキーワードマッチングを使用しています：

1. ユーザーの質問を小文字に変換
2. 各FAQの質問文とキーワードとマッチング
3. スコアの高い順にソート
4. 最もスコアの高いFAQを回答として返す

### より高度な検索の実装方法

より高度なセマンティック検索を実装する場合は、以下のオプションがあります：

1. **HuggingFace Transformers.js** (ブラウザ内でAI実行)
   - 完全無料
   - 外部サーバー不要
   - オフラインでも動作

2. **OpenAI Embeddings API** (有料だが高精度)
   - API料金が発生
   - 高精度な意味検索

3. **Google Cloud Natural Language API** (一定量無料)
   - 月間5,000リクエストまで無料
   - 日本語に強い

## 🔐 セキュリティについて

このシステムは以下のセキュリティ対策を実装しています：

- ✅ XSS対策: HTMLエスケープ処理
- ✅ CORS設定: クロスオリジン制限
- ✅ データ検証: 入力値のバリデーション

### 本番環境への展開時の注意

本番環境で使用する場合は、以下の対策を推奨します：

1. **認証機能の追加**: 管理画面へのアクセス制限
2. **HTTPS化**: SSL/TLS証明書の導入
3. **レート制限**: APIへの過剰なリクエスト防止
4. **データベース化**: PostgreSQLやMongoDBへの移行

## 📊 API仕様

### チャットAPI

**POST** `/api/chat`

リクエスト:
```json
{
  "message": "営業時間を教えてください"
}
```

レスポンス:
```json
{
  "answer": "営業時間は平日9:00〜18:00です。",
  "relatedQuestions": ["返品は可能ですか？", "送料はいくらですか？"]
}
```

### FAQ管理API

- **GET** `/api/faqs` - 全FAQ取得
- **GET** `/api/faqs/popular` - 代表的なFAQ取得
- **POST** `/api/faqs` - FAQ追加
- **PUT** `/api/faqs/:id` - FAQ更新
- **DELETE** `/api/faqs/:id` - FAQ削除

## 🌐 Web公開方法

このチャットボットをWeb上で公開する方法を説明します。

### 公開までの流れ

1. **GitHubにコードをアップロード**
2. **Renderなどのホスティングサービスで公開**

### 詳細な手順

詳しい手順は、以下のファイルを参照してください：

- **📘 詳細ガイド**: `Web公開手順ガイド.md` - 完全版・詳細な説明
- **🚀 クイックスタート**: `Web公開クイックスタート.md` - 5ステップで簡単に
- **✅ チェックリスト**: `Web公開チェックリスト.txt` - 作業の確認用

### 推奨ホスティングサービス

- **Render** (推奨) - 無料プランあり、設定が簡単
  - URL: https://render.com
  - 無料プラン: 15分間アクセスがないとスリープ

- **Railway** - 無料プランあり、高速
  - URL: https://railway.app

- **Heroku** - 有名だが無料プラン終了

### 公開後の注意事項

⚠️ **無料プランの制限**
- 15分間アクセスがないと自動的にスリープします
- スリープ後、最初のアクセス時に起動まで約30秒かかります

⚠️ **データの保存について**
- Renderの無料プランでは、ファイルシステムへの書き込みが一時的です
- サーバー再起動時にデータが消える可能性があります
- 重要なデータは定期的にバックアップを取ってください

## 🌐 Googleスプレッドシート連携（オプション）

現在はJSONファイルでデータを管理していますが、Googleスプレッドシートと連携することも可能です。

### 実装方法

1. Google Sheets API を有効化
2. `googleapis` パッケージをインストール
3. `server.js` でスプレッドシートからデータを読み込むように変更

詳細な実装が必要な場合は、お知らせください。

## 🛠️ トラブルシューティング

### サーバーが起動しない

- Node.jsがインストールされているか確認: `node --version`
- ポートが使用中でないか確認: `netstat -ano | findstr :3000`

### チャットボットが応答しない

- ブラウザのコンソールでエラーを確認
- サーバーが起動しているか確認
- `faq-data.json` が存在するか確認

### FAQ管理画面が表示されない

- `public` フォルダ内のファイルが全て存在するか確認
- ブラウザのキャッシュをクリア

## 📝 ライセンス

MIT License

## 🙋 サポート

質問や問題がある場合は、以下の方法でお知らせください：

- GitHub Issues
- メール
- チャット

## 🎉 今後の機能追加予定

- [ ] 複数言語対応
- [ ] 音声入力対応
- [ ] チャット履歴の保存
- [ ] FAQのカテゴリ分類
- [ ] アナリティクス機能
- [ ] Slack/LINE連携
- [ ] Googleスプレッドシート連携

---

**作成日**: 2025年11月  
**バージョン**: 1.0.0

